name: Update YAML version and raise PR

on:
   release:
     types: [published]

   workflow_dispatch:

   pull_request:
      paths:
          - '**'

jobs:
    Update-yaml-version:
        runs-on: ubuntu-latest    
        permissions:
          contents: write
          pull-requests: write
        
        steps:
            - name: Checkout Repository
              uses: actions/checkout@v4

            - name: Update version of the yaml files
              run: |
               ls
               for file in xero_accounting.yaml xero_assets.yaml xero_bankfeeds.yaml xero_files.yaml xero-app-store.yaml xero-finance.yaml xero-identity.yaml xero-payroll-au.yaml xero-payroll-nz.yaml xero-payroll-uk.yaml xero-projects.yaml; do
                 yq eval ".info.version = \"10.1.0\"" -i "$file"
                echo "updated version in $file"
               done
               head -n 20 xero_assets.yaml
               
